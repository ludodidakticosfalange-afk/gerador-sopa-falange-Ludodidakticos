<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Portal Premium — Falange & Ludodidakticos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body{
      margin:0;
      font-family:system-ui, Arial, sans-serif;
      background:#0b1220;
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
    }
    .box{
      width:100%;
      max-width:420px;
      background:#111827;
      border-radius:16px;
      padding:20px;
      box-shadow:0 20px 60px rgba(0,0,0,.5);
    }
    h1{
      margin:0 0 6px;
      font-size:20px;
      text-align:center;
    }
    .sub{
      font-size:12px;
      color:#9ca3af;
      text-align:center;
      margin-bottom:16px;
    }
    label{
      font-size:12px;
      display:block;
      margin-bottom:6px;
      color:#e5e7eb;
    }
    input{
      width:100%;
      padding:10px;
      border-radius:10px;
      border:none;
      margin-bottom:12px;
      font-size:14px;
    }
    button{
      width:100%;
      padding:12px;
      border-radius:12px;
      border:none;
      background:#2563eb;
      color:#fff;
      font-weight:800;
      font-size:14px;
      cursor:pointer;
    }
    .msg{
      margin-top:10px;
      font-size:12px;
      color:#fca5a5;
      text-align:center;
      min-height:16px;
    }
    .footer{
      margin-top:16px;
      font-size:11px;
      color:#9ca3af;
      text-align:center;
    }
  </style>
</head>
<body>

  <div class="box">
    <h1>Portal Premium</h1>
    <div class="sub">Falange Educación Lúdica &amp; Ludodidakticos</div>

    <label>Código de acesso</label>
    <input id="code" placeholder="Digite seu código" />

    <button onclick="entrar()">Entrar</button>
<div id="statusAssinatura" style="
  margin:10px 0;
  font-weight:700;
  text-align:center;
"></div>

    <div id="msg" class="msg"></div>

    <div class="footer">
      Assinatura educacional • Uso profissional
    </div>
  </div>

  <script>
    function normCode(s){
  return String(s || "")
    .trim()
    .toUpperCase()
    .replace(/\s+/g, "")
    .replace(/–/g, "-")
    .replace(/—/g, "-");
}

// PASSO 3: lista mínima com 1 cliente/código (teste)
const CLIENTES = [
  { code: "LUDO-FALANGE-TESTE01", activatedAt: "2025-12-17", days: 3 }
];


function findCliente(code){
  return CLIENTES.find(c => normCode(c.code) === code) || null;
}

function clienteAtivo(cliente){
  if(!cliente) return false;

  const start = new Date(cliente.activatedAt + "T00:00:00");
  const ms = Number(cliente.days) * 24 * 60 * 60 * 1000;
  const end = new Date(start.getTime() + ms);

  return new Date() < end;
}

function entrar(){
  const raw = document.getElementById("code").value;
  const code = normCode(raw);

  if(!code){
    document.getElementById("msg").textContent = "Digite o código para continuar.";
    return;
  }

  const cliente = findCliente(code);

if(!cliente){
  document.getElementById("msg").textContent = "Código inválido.";
  return;
}

if(!clienteAtivo(cliente)){
  document.getElementById("msg").textContent = "Assinatura expirada. Fale com o suporte para renovar.";
  return;
}


  // liberou: entra no gerador
  document.getElementById("msg").textContent = "";
localStorage.setItem("falange_ok", "1");
localStorage.setItem("falange_activatedAt", cliente.activatedAt);
localStorage.setItem("falange_days", cliente.days);

window.location.href = "hub.html";

}
function verificarAssinatura() {
  const dataStr = localStorage.getItem("falange_activatedAt");
  const dias = Number(localStorage.getItem("falange_days") || 0);
  const statusEl = document.getElementById("statusAssinatura");

  if (!statusEl) return;

  if (!dataStr || !dias) {
    statusEl.textContent = "❌ Nenhuma assinatura ativa";
    statusEl.style.color = "#dc2626";
    return;
  }

  const inicio = new Date(dataStr);
  const agora = new Date();
  const diff = Math.floor((agora - inicio) / (1000 * 60 * 60 * 24));
  const restante = dias - diff;

  if (restante <= 0) {
    statusEl.textContent = "⛔ Assinatura expirada";
    statusEl.style.color = "#dc2626";
    localStorage.removeItem("falange_ok");
    return;
  }

  statusEl.textContent = `✅ Assinatura ativa — ${restante} dia(s) restantes`;
  statusEl.style.color = "#16a34a";
}

document.addEventListener("DOMContentLoaded", verificarAssinatura);

</script>

</body>
</html>
